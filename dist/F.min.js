!function(a){if(!a.Promise){var b=function(a){var b=this;this._value=void 0,this._resolved=!1,this._callbacks=[],a(function(a){b._value=a,b._resolved=!0;for(var c=0;c<b._callbacks.length;c++)b._callbacks[c](a)})};b.prototype.then=function(a){this._resolved?a(this._value):this._callbacks.push(a)},a.Promise=b}}(this),function(a){var b=function(){};b.and=function(){var a=arguments;return a&&Array.isArray(a[0])&&(a=a[0]),function(b){for(var c=0;c<a.length;c++)if(!a[c](b))return!1;return!0}},b.or=function(){var a=arguments;return a&&Array.isArray(a[0])&&(a=a[0]),function(b){for(var c=0;c<a.length;c++)if(a[c](b))return!0;return!1}},b.not=function(a){return function(){return!a.apply(this,arguments)}},b.alwaysTrue=function(){return!0},b.alwaysFalse=function(){return!1},b.isNull=function(a){return null===a},b.notNull=function(a){return null!==a},b.hasProperty=function(){var a=arguments;return function(b){for(var c=0;c<a.length;c++){if("undefined"==typeof b[a[c]])return!1;b=b[a[c]]}return!0}},b["in"]=function(a){return function(b){return-1!==a.indexOf(b)}},b.equalTo=function(a){return function(b){return b==a}},b.strongEqualTo=function(a){return function(b){return b===a}},b.instanceOf=function(a){return function(b){return b instanceof a}},b.on=function(){var a=arguments[arguments.length-1],b=arguments;return function(c){for(var d=0;d<b.length-1;d++){if("undefined"==typeof c[b[d]])return!1;c=c[b[d]]}return a(c)}},b.count=function(a){return function(){return a-->0?!0:!1}},b.limit=function(a){return function(){return--a>0?!0:!1}},a.P=b}(this),function(a){var b=a.P,c=function(a){return a instanceof p?a:new p("function"==typeof a.next?a:a instanceof Function?new g(a):"number"==typeof a.length?new e(a):new f(a))},d=function(a){return"undefined"==typeof a.value},e=function(a){this._collection=a,this._index=-1};e.prototype.next=function(){return this._index++,{value:this._collection[this._index],done:this._index>=this._collection.length-1}};var f=function(a){this._keys=Object.keys(a),this._obj=a,this._index=-1};f.prototype.next=function(){var a=this._keys[++this._index],b={done:this._index>=this._keys.length};return b.done||(b.value=[a,this._obj[a]]),b};var g=function(a){this._index=-1,this._func=a};g.prototype.next=function(){var a=this._func(++this._index);return{value:a,done:"undefined"==typeof a}};var h=function(a,b){this._iter=a,this._func=b};h.prototype.next=function(){var a=this._iter.next();return d(a)?a:{value:this._func(a.value),done:a.done}};var i=function(a,b){this._iter=a,this._pred=b};i.prototype.next=function(){var a=this._iter.next();return d(a)||this._pred(a.value)||delete a.value,a};var j=function(a,b){this._iter=a,this._func=b};j.prototype.next=function(){var a=this._iter.next();return d(a)||this._func(a.value),a};var k=function(a,b){this._iter=a,this._pred=b,this._buffer=[]};k.prototype.next=function(){var a=this._iter.next();return d(a)||(this._buffer.push(a.value),this._pred(a.value)?a.value=this._buffer.splice(0):delete a.value),a};var l=function(a,b){this._iter=a,this._count=b};l.prototype.next=function(){var a=this._iter.next();return d(a)||--this._count<=0&&(a.done=!0),a};var m=function(a,b){this._iter=a,this._pred=b};m.prototype.next=function(){var a=this._iter.next();return d(a)||this._pred(a.value)||(delete a.value,a.done=!0),a};var n=function(a,b){this._liter=a,this._riter=b,this._lbuffer=[],this._rbuffer=[]};n.prototype._read=function(a,b){var d=a.next();return c.isEmptyValue(d)||b.push(d),d.done},n.prototype.next=function(){var a=this._read(this._liter,this._lbuffer),b=this._read(this._riter,this._rbuffer),c=a&&b;return this._lbuffer.length&&this._rbuffer.length?{value:[this._lbuffer.shift().value,this._rbuffer.shift().value],done:c}:{done:c}};var o=function(a){this._iterators=a.slice(1),this._activeIter=a.length?a[0]:c([])._iter};o.prototype.next=function(){for(var a;;){if(a=this._activeIter.next(),!d(a)||!this._iterators.length)break;this._activeIter=this._iterators[0],this._iterators=this._iterators.slice(1)}return a.done&&this._iterators.length&&(a.done=!1,this._activeIter=this._iterators[0],this._iterators=this._iterators.slice(1)),a};var p=function(a){this._iter=a};p.prototype.concat=function(){return c(new o([this._iter].concat(c(arguments).map(function(a){return c(a)._iter}).toArray())))},p.prototype.flatten=function(){return c(new o(this.map(function(a){return c(a)._iter}).toArray()))},p.prototype.map=function(a){return c(new h(this._iter,a))},p.prototype.filter=function(a){return c(new i(this._iter,a))},p.prototype.zip=function(a){return c(new n(this._iter,c(a)._iter))},p.prototype.toArray=function(){var a,b=[];do a=this._iter.next(),d(a)||b.push(a.value);while(!a.done);return b},p.prototype.toMap=function(){var a,b={};do a=this._iter.next(),d(a)||(b[a.value[0]]=a.value[1]);while(!a.done);return b},p.prototype.partition=function(a){var b,c=[[],[]];do b=this._iter.next(),d(b)||(a(b.value)?c[0].push(b.value):c[1].push(b.value));while(!b.done);return c},p.prototype.find=function(a){var b;do if(b=this._iter.next(),!d(b)&&a(b.value))return b.value;while(!b.done)},p.prototype.findIndex=function(a){var b,c=-1;do if(b=this._iter.next(),c++,!d(b)&&a(b.value))return c;while(!b.done);return-1},p.prototype.drop=function(a){return c(new i(this._iter,b.not(b.count(a))))},p.prototype.take=function(a){return c(new l(this._iter,a))},p.prototype.dropWhile=function(a){var b=!1;return c(new i(this._iter,function(c){return b?!0:a(c)?!1:(b=!0,!0)}))},p.prototype.takeWhile=function(a){return c(new m(this._iter,a))},p.prototype.fold=function(a,b){var c;do c=this._iter.next(),d(c)||(b="undefined"==typeof b?c.value:a(b,c.value));while(!c.done);return b},p.prototype.foreach=function(a){var b,c=0;do b=this._iter.next(),d(b)||a(b.value,c++,b.done);while(!b.done)},p.prototype.each=function(a){return c(new j(this._iter,a))},p.prototype.feedStream=function(a){return c(new j(this._iter,function(b){a.push(b)}))},p.prototype.reverse=function(){var a,b=[];do a=this._iter.next(),d(a)||b.unshift(a.value);while(!a.done);return c(b)},p.prototype.unique=function(){var a=[];return c(new i(this._iter,function(b){return-1===a.indexOf(b)?(a.push(b),!0):!1}))},p.prototype.property=function(){var a=arguments;return c(new h(this._iter,function(b){for(var c=0;c<a.length;c++){if("undefined"==typeof b[a[c]])return null;b=b[a[c]]}return b}))},p.prototype.keys=function(){arguments;return c(new h(this._iter,function(a){return a[0]}))},p.prototype.values=function(){arguments;return c(new h(this._iter,function(a){return a[1]}))},p.prototype.accumulateUntil=function(a){return c(new k(this._iter,a))},p.prototype.log=function(){return c(new j(this._iter,function(b){a.console&&console.log(b)}))},p.prototype.all=function(a){return c(this._iter).fold(function(b,c){return b&&a(c)},!0)},p.prototype.some=function(a){return c(this._iter).fold(function(b,c){return b||a(c)},!1)},p.prototype.none=function(a){return c(this._iter).fold(function(b,c){return b&&!a(c)},!0)},p.prototype.max=function(a){return a||(a=function(a,b){return a>b}),c(this._iter).fold(function(b,c){return a(b,c)?b:c})},p.prototype.min=function(a){return a||(a=function(a,b){return b>a}),c(this._iter).max(a)},c.Iterable=p,c.isEmptyValue=d,a.F=c}(this),function(a){var b=a.F,c=a.P,d=a.Promise;b.stream=function(a){return b.lastStream=new e(a)},b.eventStream=function(a,c){var d=b.stream(),e=function(a){d.push(a)};return"function"==typeof a.addEventListener?(a.addEventListener(c,e),d.done(function(){a.removeEventListener(c,e)})):"function"==typeof a.on&&(a.on(c,e),d.done(function(){a.off(c,e)})),d},b.estream=b.eventStream,b.multiplexStream=function(){var a,c=b.stream(),d=0,e=function(a){c.push(a)},f=function(){++d===a.length&&c.stop()};a=Array.isArray(arguments[0])?arguments[0]:arguments;for(var g=0;g<a.length;g++)a[g].then(e).done(f);return c},b.mplex=b.multiplexStream,b.intervalStream=function(a,c){var d=b.stream(),e=setInterval(function(){d.push(a)},c);return d.done(function(){clearInterval(e)}),d},b.timerStream=function(a,c){var d=b.stream(),e=setTimeout(function(){d.push(a),d.stop()},c);return d.done(function(){clearTimeout(e)}),d};var e=function(a){this._done=!1,this._eventListeners=[],this._doneListeners=[],this._size=a||1,this._buffer=[]};e.prototype.then=function(a){return this._eventListeners.push(a),this},e.prototype.done=function(a){return this._doneListeners.push(a),this},e.prototype.push=function(a){if(this._done)return this;this._buffer.push(a),this._buffer.length>this._size&&this._buffer.shift();for(var b=0;b<this._eventListeners.length;b++)this._eventListeners[b](a);return this},e.prototype.pushAll=function(a){if(!this._done){for(var b=0;b<a.length;b++)this.push(a[b]);return this}},e.prototype.next=function(){var a={value:this._buffer.shift(),done:this._done};return a},e.prototype.stop=function(){if(!this._done){delete this._value,this._done=!0;for(var a=0;a<this._doneListeners.length;a++)this._doneListeners[a]()}},b.Iterable.prototype.pullStream=function(a,e){e||(e=c.alwaysTrue);var f=this;return new d(function(c){var d=[];a.then(function(){var c=f._iter.next();b.isEmptyValue(c)||d.push(c.value),(!e(c.value)||c.done)&&a.stop()}),a.done(function(){c(d)})})}}(this),function(a){var b={F:a.F,P:a.P,Promise:a.Promise};"function"==typeof define&&define.amd?define([],function(){return b}):"object"==typeof exports&&(module.exports=b)}(this);