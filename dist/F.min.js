!function(a){if(!a.Promise){var b=function(a){var b=this;this._value=void 0,this._resolved=!1,this._callbacks=[],a(function(a){b._value=a,b._resolved=!0;for(var c=0;c<b._callbacks.length;c++)b._callbacks[c](a)})};b.prototype.then=function(a){this._resolved?a(this._value):this._callbacks.push(a)},a.Promise=b}}(this),function(a){var b=function(a){return a instanceof q?a:new q("function"==typeof a.next?a:a instanceof Function?new f(a):"number"==typeof a.length?new d(a):new e(a))},c=function(a){return"undefined"==typeof a.value},d=function(a){this._collection=a,this._index=-1};d.prototype.next=function(){return this._index++,{value:this._collection[this._index],done:this._index>=this._collection.length-1}};var e=function(a){this._keys=Object.keys(a),this._obj=a,this._index=-1};e.prototype.next=function(){var a=this._keys[++this._index],b={done:this._index>=this._keys.length};return b.done||(b.value=[a,this._obj[a]]),b};var f=function(a){this._index=-1,this._func=a};f.prototype.next=function(){var a=this._func(++this._index);return{value:a,done:"undefined"==typeof a}};var g=function(a,b){this._iter=a,this._func=b};g.prototype.next=function(){var a=this._iter.next();return c(a)?a:{value:this._func(a.value),done:a.done}};var h=function(a,b){this._iter=a,this._pred=b};h.prototype.next=function(){var a=this._iter.next();return c(a)||this._pred(a.value)||delete a.value,a};var i=function(a,b){this._iter=a,this._func=b};i.prototype.next=function(){var a=this._iter.next();return c(a)||this._func(a.value),a};var j=function(a,b){this._iter=a,this._pred=b,this._buffer=[]};j.prototype.next=function(){var a=this._iter.next();return c(a)||(this._buffer.push(a.value),this._pred(a.value)?a.value=this._buffer.splice(0):delete a.value),a};var k=function(a,b){this._iter=a,this._count=b};k.prototype.next=function(){var a=this._iter.next();return c(a)||this._count-->0&&delete a.value,a};var l=function(a,b){this._iter=a,this._count=b};l.prototype.next=function(){var a=this._iter.next();return c(a)||--this._count<=0&&(a.done=!0),a};var m=function(a,b){this._iter=a,this._pred=b,this._dropped=!1};m.prototype.next=function(){var a=this._iter.next();return c(a)||this._dropped||(this._pred(a.value)?delete a.value:this._dropped=!0),a};var n=function(a,b){this._iter=a,this._pred=b};n.prototype.next=function(){var a=this._iter.next();return c(a)||this._pred(a.value)||(delete a.value,a.done=!0),a};var o=function(a,b){this._liter=a,this._riter=b,this._lbuffer=[],this._rbuffer=[]};o.prototype._read=function(a,c){var d=a.next();return b.isEmptyValue(d)||c.push(d),d.done},o.prototype.next=function(){var a=this._read(this._liter,this._lbuffer),b=this._read(this._riter,this._rbuffer),c=a&&b;return this._lbuffer.length&&this._rbuffer.length?{value:[this._lbuffer.shift().value,this._rbuffer.shift().value],done:c}:{done:c}};var p=function(a){this._iterators=a.slice(1),this._activeIter=a.length?a[0]:b([])._iter};p.prototype.next=function(){for(var a;;){if(a=this._activeIter.next(),!c(a)||!this._iterators.length)break;this._activeIter=this._iterators[0],this._iterators=this._iterators.slice(1)}return a.done&&this._iterators.length&&(a.done=!1,this._activeIter=this._iterators[0],this._iterators=this._iterators.slice(1)),a};var q=function(a){this._iter=a};q.prototype.concat=function(){return b(new p([this._iter].concat(b(arguments).map(function(a){return b(a)._iter}).toArray())))},q.prototype.flatten=function(){return b(new p(this.map(function(a){return b(a)._iter}).toArray()))},q.prototype.map=function(a){return b(new g(this._iter,a))},q.prototype.filter=function(a){return b(new h(this._iter,a))},q.prototype.zip=function(a){return b(new o(this._iter,b(a)._iter))},q.prototype.toArray=function(){var a,b=[];do a=this._iter.next(),c(a)||b.push(a.value);while(!a.done);return b},q.prototype.toMap=function(){var a,b={};do a=this._iter.next(),c(a)||(b[a.value[0]]=a.value[1]);while(!a.done);return b},q.prototype.partition=function(a){var b,d=[[],[]];do b=this._iter.next(),c(b)||(a(b.value)?d[0].push(b.value):d[1].push(b.value));while(!b.done);return d},q.prototype.find=function(a){var b;do if(b=this._iter.next(),!c(b)&&a(b.value))return b.value;while(!b.done)},q.prototype.findIndex=function(a){var b,d=-1;do if(b=this._iter.next(),d++,!c(b)&&a(b.value))return d;while(!b.done);return-1},q.prototype.drop=function(a){return b(new k(this._iter,a))},q.prototype.take=function(a){return b(new l(this._iter,a))},q.prototype.dropWhile=function(a){return b(new m(this._iter,a))},q.prototype.takeWhile=function(a){return b(new n(this._iter,a))},q.prototype.fold=function(a,b){var d;do d=this._iter.next(),c(d)||(b="undefined"==typeof b?d.value:a(b,d.value));while(!d.done);return b},q.prototype.foreach=function(a){var b,d=0;do b=this._iter.next(),c(b)||a(b.value,d++,b.done);while(!b.done)},q.prototype.each=function(a){return b(new i(this._iter,a))},q.prototype.feedStream=function(a){return b(new i(this._iter,function(b){a.push(b)}))},q.prototype.reverse=function(){var a,d=[];do a=this._iter.next(),c(a)||d.unshift(a.value);while(!a.done);return b(d)},q.prototype.unique=function(){var a=[];return b(new h(this._iter,function(b){return-1===a.indexOf(b)?(a.push(b),!0):!1}))},q.prototype.property=function(){var a=arguments;return b(new g(this._iter,function(b){for(var c=0;c<a.length;c++){if("undefined"==typeof b[a[c]])return null;b=b[a[c]]}return b}))},q.prototype.keys=function(){arguments;return b(new g(this._iter,function(a){return a[0]}))},q.prototype.values=function(){arguments;return b(new g(this._iter,function(a){return a[1]}))},q.prototype.accumulateUntil=function(a){return b(new j(this._iter,a))},q.prototype.log=function(){return b(new i(this._iter,function(a){console.log(a)}))},q.prototype.all=function(a){return b(this._iter).fold(function(b,c){return b&&a(c)},!0)},q.prototype.some=function(a){return b(this._iter).fold(function(b,c){return b||a(c)},!1)},q.prototype.none=function(a){return b(this._iter).fold(function(b,c){return b&&!a(c)},!0)},q.prototype.max=function(a){return a||(a=function(a,b){return a>b}),b(this._iter).fold(function(b,c){return a(b,c)?b:c})},q.prototype.min=function(a){return a||(a=function(a,b){return b>a}),b(this._iter).fold(function(b,c){return a(b,c)?b:c})},b.Iterable=q,b.isEmptyValue=c,a.F=b}(this),function(a){var b=function(){};b.and=function(){var a=arguments;return a&&Array.isArray(a[0])&&(a=a[0]),function(b){for(var c=0;c<a.length;c++)if(!a[c](b))return!1;return!0}},b.or=function(){var a=arguments;return a&&Array.isArray(a[0])&&(a=a[0]),function(b){for(var c=0;c<a.length;c++)if(a[c](b))return!0;return!1}},b.not=function(a){return function(b){return!a(b)}},b.alwaysTrue=function(){return!0},b.alwaysFalse=function(){return!1},b.isNull=function(a){return null===a},b.notNull=function(a){return null!==a},b.hasProperty=function(){var a=arguments;return function(b){for(var c=0;c<a.length;c++){if("undefined"==typeof b[a[c]])return!1;b=b[a[c]]}return!0}},b["in"]=function(a){return function(b){return-1!==a.indexOf(b)}},b.equalTo=function(a){return function(b){return b==a}},b.strongEqualTo=function(a){return function(b){return b===a}},b.instanceOf=function(a){return function(b){return b instanceof a}},b.on=function(){var a=arguments[arguments.length-1],b=arguments;return function(c){for(var d=0;d<b.length-1;d++){if("undefined"==typeof c[b[d]])return!1;c=c[b[d]]}return a(c)}},b.count=function(a){return function(){return a-->0?!0:!1}},b.limit=function(a){return function(){return--a>0?!0:!1}},a.P=b}(this),function(a){var b=a.F,c=a.P,d=a.Promise;b.stream=function(a){return b.lastStream=new e(a)},b.eventStream=function(a,c){var d=b.stream(),e=function(a){d.push(a)};return"function"==typeof a.addEventListener?(a.addEventListener(c,e),d.done(function(){a.removeEventListener(c,e)})):"function"==typeof a.on&&(a.on(c,e),d.done(function(){a.off(c,e)})),d},b.estream=b.eventStream,b.multiplexStream=function(){var a,c=b.stream(),d=0,e=function(a){c.push(a)},f=function(){++d===a.length&&c.stop()};a=Array.isArray(arguments[0])?arguments[0]:arguments;for(var g=0;g<a.length;g++)a[g].then(e).done(f);return c},b.mplex=b.multiplexStream,b.intervalStream=function(a,c){var d=b.stream(),e=setInterval(function(){d.push(a)},c);return d.done(function(){clearInterval(e)}),d},b.timerStream=function(a,c){var d=b.stream(),e=setTimeout(function(){d.push(a),d.stop()},c);return d.done(function(){clearTimeout(e)}),d};var e=function(a){this._done=!1,this._eventListeners=[],this._doneListeners=[],this._size=a||1,this._buffer=[]};e.prototype.then=function(a){return this._eventListeners.push(a),this},e.prototype.done=function(a){return this._doneListeners.push(a),this},e.prototype.push=function(a){if(this._done)return this;this._buffer.push(a),this._buffer.length>this._size&&this._buffer.shift();for(var b=0;b<this._eventListeners.length;b++)this._eventListeners[b](a);return this},e.prototype.pushAll=function(a){if(!this._done){for(var b=0;b<a.length;b++)this.push(a[b]);return this}},e.prototype.next=function(){var a={value:this._buffer.shift(),done:this._done};return a},e.prototype.stop=function(){if(!this._done){delete this._value,this._done=!0;for(var a=0;a<this._doneListeners.length;a++)this._doneListeners[a]()}},b.Iterable.prototype.pullStream=function(a,e){e||(e=c.alwaysTrue);var f=this;return new d(function(c){var d=[];a.then(function(){var c=f._iter.next();b.isEmptyValue(c)||d.push(c.value),(!e(c.value)||c.done)&&a.stop()}),a.done(function(){c(d)})})}}(this),function(a){var b={F:a.F,P:a.P,Promise:a.Promise};"function"==typeof define&&define.amd?define([],function(){return b}):"object"==typeof exports&&(module.exports=b)}(this);